(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["admin"],{"24c3":function(e,t,s){},3530:function(e,t,s){"use strict";s.r(t);var o=function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",[s("div",{staticClass:"top-background"}),s("div",{staticClass:"margin-20"},[s("div",{staticClass:"d-flex pt-5 flex-wrap body hg-100"},[s("div",{staticClass:"d-block image-container",attrs:{id:"carousel"}},[s("carousel",{attrs:{navigationEnabled:!0,perPage:1,touchDrag:!1,mouseDrag:!1}},e._l(e.comprovantes,function(t,o){return"reserved"===t.status?s("slide",{key:o},[s("div",{staticClass:"width:100%"},[e.canRenderCarousel?s("img",{attrs:{src:t.url,alt:""}}):e._e(),s("div",{staticClass:"text-center"},[s("small",{attrs:{for:""}},[e._v("Comprador:")]),s("small",[e._v("\n                  "+e._s(t.user)+"\n                ")]),s("el-divider",{attrs:{direction:"vertical"}}),s("small",{attrs:{for:""}},[e._v("Números comprados:")]),s("small",[e._v("\n                  "+e._s(t.numbers.length)+"\n                ")]),s("div",{staticClass:"d-block mt-2"},[s("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(s){return e.previousPage(t)}}}),s("el-button",{attrs:{type:"success",icon:"el-icon-check",circle:""},on:{click:function(s){return e.nextPage(t)}}})],1)],1)])]):e._e()}),1)],1)])]),s("el-dialog",{attrs:{title:"Reservar número "+e.openedNumer,visible:e.dialogVisible,width:e.returnModalWidth},on:{"update:visible":function(t){e.dialogVisible=t}}},[s("div",{staticClass:"form-row"},[s("div",{staticClass:"col-12"},[s("label",{attrs:{for:""}},[e._v("Nome Completo")]),s("el-input",{attrs:{placeholder:"Insira seu nome"},model:{value:e.form.user,callback:function(t){e.$set(e.form,"user",t)},expression:"form.user"}})],1),s("div",{staticClass:"col-12 mt-3"},[s("label",{attrs:{for:""}},[e._v("Telefone")]),s("el-input",{directives:[{name:"mask",rawName:"v-mask",value:["(##) ####-####","(##) #####-####"],expression:"['(##) ####-####', '(##) #####-####']"}],attrs:{placeholder:"Insira seu telefone"},model:{value:e.form.celular,callback:function(t){e.$set(e.form,"celular",t)},expression:"form.celular"}})],1),s("div",{staticClass:"col-12 mt-3"},[s("label",{attrs:{for:""}},[e._v("E-mail")]),s("el-input",{attrs:{placeholder:"Insira seu E-mail"},model:{value:e.form.email,callback:function(t){e.$set(e.form,"email",t)},expression:"form.email"}})],1),s("div",{staticClass:"col-12 mt-3"},[s("label",{attrs:{for:""}},[e._v("Números Adicionais\n          "),s("small",{staticClass:"d-block"},[e._v("(opcional deixe vazio caso seja apenas um)")])]),s("el-select",{staticClass:"w-100",attrs:{multiple:"",placeholder:"Selecione"},model:{value:e.form.numbers,callback:function(t){e.$set(e.form,"numbers",t)},expression:"form.numbers"}},e._l(e.returnNumbers,function(t,o){return t.reserved?e._e():s("el-option",{key:o,attrs:{label:t.number,value:t.number}})}),1)],1),s("div",{staticClass:"col-12 mt-3"},[s("label",{attrs:{for:""}},[e._v("Upload do comprovante (R$ 20,00 por número)")]),s("el-upload",{directives:[{name:"loading",rawName:"v-loading",value:e.loadingUpload,expression:"loadingUpload"}],staticClass:"upload-demo",attrs:{action:"","on-change":e.fileInput,"file-list":e.fileList,"auto-upload":!1,"list-type":"picture"}},[s("el-button",{attrs:{size:"small",type:"primary"}},[e._v("Clique para fazer o upload")]),s("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("\n            aceito arquivos jpg/png\n          ")])],1)],1)]),s("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[s("el-button",{on:{click:function(t){e.dialogVisible=!1}}},[e._v("Cancelar")]),s("el-button",{attrs:{disabled:e.returnDisabled,type:"primary"},on:{click:function(t){return e.finishPayment()}}},[e._v("Confirmar")])],1)])],1)},a=[],r=(s("7f7f"),s("96cf"),s("3b8d")),n=(s("7514"),s("ac6a"),s("ac34")),i={name:"principal",data:function(){return{canRenderCarousel:!1,updateCarousel:0,comprovantes:[],loadingUpload:!1,reservedNumbers:[],uploaded:!1,fileList:[],dialogVisible:!1,form:{user:"",celular:"",email:"",numbers:[],url:"",status:"reserved"},openedNumer:"",unsubscribe:""}},mounted:function(){var e=this;this.unsubscribe=n["b"].onSnapshot(function(t){t.docChanges().forEach(function(t){var s=t.doc.data(),o=t.doc.id,a=e;s.id=o,e.updateCarousel+=1,setTimeout(function(){a.canRenderCarousel=!0;var e=document.getElementsByClassName("VueCarousel-dot");e[0].click()},2e3),e.comprovantes.push(s),s.numbers.map(function(t){e.reservedNumbers.find(function(e){return e===t})||e.reservedNumbers.push({number:t,user:s.user})})})}),this.loadingTimer()},computed:{returnModalWidth:function(){return console.log(document.body.clientWidth),document.body.clientWidth>600?"40%":"80%"},returnNumbers:function(){var e,t=[];for(e=1;e<=150;e++){var s=this.reservedNumbers.find(function(t){return t.number===e});s?t.push({number:e,user:s.user,reserved:!0}):t.push({number:e,user:"",reserved:!1})}return t},returnDisabled:function(){return""==this.form.user||""==this.form.celular||""==this.form.email||this.form.numbers==[]||!this.uploaded}},methods:{nextPage:function(e){var t=this;this.unsubscribe();var s=Object.assign({},e);s.status="confirmed",n["b"].doc(s.id).update(s).then(function(){var e=document.getElementsByClassName("VueCarousel-navigation-next");e[0].click(),t.$message({message:"Número confirmado com sucesso!!",type:"success"})})},previousPage:function(e){var t=this;this.unsubscribe();var s=Object.assign({},e);s.status="deleted",n["b"].doc(s.id).delete().then(function(){var e=document.getElementsByClassName("VueCarousel-navigation-next");e[0].click(),t.$message({message:"Número deletado com sucesso!!",type:"success"})})},finishPayment:function(){var e=this;console.log(this.form),n["b"].doc().set(this.form).then(function(){console.log("Document successfully written!"),e.dialogVisible=!1,e.uploaded=!1,e.form={user:"",celular:"",email:"",numbers:[],url:"",status:"reserved"},e.fileList=[],e.$message({message:"Obrigado pela contribuição e boa sorte!!",type:"success"})}).catch(function(e){console.error("Error writing document: ",e)})},openDialog:function(e){this.form.numbers=[e],this.openedNumer=e,this.dialogVisible=!0},fileInput:function(){var e=Object(r["a"])(regeneratorRuntime.mark(function e(t){var s,o,a,r,i;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:try{t&&t.name&&(this.processing=!0,s=t.url,o=new FormData,o.append("image",t),a="comprovantes/".concat(Date.now(),"-").concat(t.name),r={contentType:t.type},i=this,i.loadingUpload=!0,fetch(s).then(function(e){return e.blob()}).then(function(e){return n["a"].ref().child(a).put(e,r).then(function(e){console.log(e),console.log("Uploaded a blob!"),console.log("filePath: ",a),i.uploaded=!0,i.loadingUpload=!1,n["a"].ref().child(a).getDownloadURL().then(function(e){console.log(e),i.form.url=e}).catch(function(e){console.log(e)})})}))}catch(l){console.error(l)}finally{this.processing=!1}case 1:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),loadingTimer:function(){var e=this;this.$store.commit("SET_LOADING_STATUS",!0),setTimeout(function(){e.$store.commit("SET_LOADING_STATUS",!1),e.show=!0},2e3)}}},l=i,c=(s("4a9a"),s("2877")),u=Object(c["a"])(l,o,a,!1,null,null,null);t["default"]=u.exports},"4a9a":function(e,t,s){"use strict";var o=s("24c3"),a=s.n(o);a.a}}]);
//# sourceMappingURL=admin.afb077cf.js.map